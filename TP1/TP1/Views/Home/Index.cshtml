@model TP1.Models.LoginModel
@{
    ViewBag.Title = "My Todo List";
}
@functions{

    /// <summary>
    ///     The get anti forgery token.
    /// </summary>
    /// <returns>
    ///     The <see cref="string" />.
    /// </returns>
    public string GetAntiForgeryToken()
    {
        string cookieToken, formToken;
        AntiForgery.GetTokens(null, out cookieToken, out formToken);
        return cookieToken + ":" + formToken;
    }

}

<header>
    @Html.KnockoutHelperFor("SiteName", "h1")
</header>

<div id="main-content">
    @if (@User.Identity.IsAuthenticated)
    {
        <h2>Index</h2>
        <div id="studentListGrid">
            <table class="grdTbl">
                <thead class="grdTblHead">
                    <tr>
                        <th><a href="#" onclick="window.reportApp.eW.Dashboard.StudentDataGrid.Sort('Name')" class="sortCol">@Html.KnockoutHelperFor("Title", "p")</a></th>
                        <th><a href="#" onclick="window.reportApp.eW.Dashboard.StudentDataGrid.Sort('Age')" class="sortCol">@Html.KnockoutHelperFor("ZipCode", "p")</a></th>
                        <th>@Html.KnockoutHelperFor("City", "p")</th>
                        <th>@Html.KnockoutHelperFor("DateAdded", "p")</th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: window.reportApp.eW.Dashboard.StudentDataGrid.DataRows">
                    <tr>
                        <td data-bind="text: Title"></td>
                        <td data-bind="text: ZipCode"></td>
                        <td data-bind="text: City.Name"></td>
                        <td data-bind="text: DateAdded"></td>
                    </tr>
                </tbody>
            </table>
            <div class="pagerWrap">
                <ul class="grdLinePager">
                    <li class="liBgFirst"><a href="#" onclick="window.reportApp.eW.Dashboard.StudentDataGrid.FlipPage(1)"></a></li>
                    <li class="liBgPrev"><a href="#" data-bind="click: function () { window.reportApp.eW.Dashboard.StudentDataGrid.FlipPage(window.reportApp.eW.Dashboard.StudentDataGrid.GridParams.pageIndex() - 1)  }"></a></li>
                    <li class="liBgCur">
                        <input data-bind="value: window.reportApp.eW.Dashboard.StudentDataGrid.GridParams.requestedPage" type="text" />
                        <span>of total</span>
                        <span data-bind="text: window.reportApp.eW.Dashboard.StudentDataGrid.GridParams.totalPages()"></span>
                        <span> pages</span>
                    </li>
                    <li class="liBGNext"><a href="#" data-bind="click: function () { window.reportApp.eW.Dashboard.StudentDataGrid.FlipPage(window.reportApp.eW.Dashboard.StudentDataGrid.GridParams.pageIndex() + 1) }"></a></li>
                    <li class="liBGLast"><a href="#" data-bind="click: function () { window.reportApp.eW.Dashboard.StudentDataGrid.FlipPage(window.reportApp.eW.Dashboard.StudentDataGrid.GridParams.totalPages()) }"></a></li>
                </ul>
                <div class="pagerNumWrap">
                    <span># of rows in page </span>
                    <select data-bind="options: window.reportApp.eW.Dashboard.StudentDataGrid.GridParams.pageSizeOptions, value: window.reportApp.eW.Dashboard.StudentDataGrid.SelectedPageSizeOption "></select>
                </div>
                <!--this is for demo only. unhide it in style to view -->
                <ul class="grdPager" data-bind="foreach: new Array(window.reportApp.eW.Dashboard.StudentDataGrid.GridParams.totalPages())" style="display:none">
                    <li><a href='#' data-bind="click: function () { window.reportApp.eW.Dashboard.StudentDataGrid.FlipPage($index() + 1) }, text: ($index() + 1), style: { color: ($index() + 1) == window.reportApp.eW.Dashboard.StudentDataGrid.GridParams.pageIndex() ? 'black' : 'blue' } "></a></li>
                </ul>
            </div>
        </div>



    }
    else
    {
        <div class="todoList" id="loginPanel">
            <section id="localLoginPanel">
                @Html.KnockoutHelperFor("LogIn", "h2")  
                @Html.Partial("_Login")
            </section>
            <section id="socialLoginPanel">
                @Html.KnockoutHelperFor("AnotherLoginServiceTitle", "h2") 
                @Html.KnockoutHelperFor("AnotherLoginServiceText") 
                <!-- @Html.Action("ExternalLoginsList", "Account", new { ViewBag.ReturnUrl })-->
            </section>
            @Html.KnockoutHelperFor("FirstTimeHere", "p")  <a id="showRegister">@Html.KnockoutHelperFor("SignUp")</a>
        </div>
        <div class="todoList" id="registerPanel">
            <h2>Sign up</h2>
            @Html.Partial("_Register")
            @Html.KnockoutHelperFor("AlreadySignedUp", "p")  <a id="showLogin">@Html.KnockoutHelperFor("LogIn") </a>
        </div>
    }
</div>

@section Scripts {
    <script type="text/javascript">

        window.reportApp.eW.Dashboard = window.reportApp.eW.Dashboard || {};
        window.reportApp.eW.Dashboard.StudentDataGrid = new window.reportApp.eW.DataGridAjax('/Report/GetReport', 10);

        window.reportApp.eW.Dashboard.Init = function () {
            window.reportApp.eW.Dashboard.StudentDataGrid.GetData();
            window.reportApp.eW.Dashboard.StudentDataGrid.DataRows.language = languageModel(availableLanguages);

            ko.applyBindings(window.reportApp.eW.Dashboard.StudentDataGrid.DataRows);
        };
        window.reportApp.eW.Dashboard.Init();

    </script>
}

@Scripts.Render("~/bundles/Report")

